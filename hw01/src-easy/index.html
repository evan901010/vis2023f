<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dummy CSV Generator</title>
  <style>
    table, th, td {
            border: 1px solid blue;
            margin: 10px auto;
            padding: 1px 3px;
        }
  </style>
</head>
<body>
  <button id="downloadButton">Download CSV</button>
  <table id="gradesTable">
    <thead>
      <tr>
        <td>序號</td>
        <td>班級</td>
        <td>學號</td>
        <td>中文姓名</td>
        <td>GitHub 帳號</td>
        <td>作業一</td>
        <td>作業二</td>
        <td>作業三</td>
        <td>作業四</td>
        <td>作業五</td>
        <td>作業六</td>
        <td>作業七</td>
        <td>作業八</td>
        <td>作業九</td>
        <td>作業十</td>
      </tr>
    </thead>
    <tbody>
      <!-- Table content will be generated by JavaScript -->
    </tbody>
  </table>

  <script>
    function generateClassAndId(indexOfClass) {
      const classOptions = ["資工", "電資AI", "電資資安", "創新AI"];
      const departmentCodes = ["590", "598", "C52", "C53", "C71"];
      const academicYears = [109, 110, 111, 112];
      const classLevels = ["三", "四", "碩一", "碩二"];
      
      let gradeIndex = Math.floor(Math.random() * classLevels.length);
      let chosenClass = classOptions[indexOfClass] + classLevels[gradeIndex];
      let studentCode = academicYears[gradeIndex] + departmentCodes[indexOfClass] + String(Math.floor(Math.random() * 999)).padStart(3, "0");
  
      return [chosenClass, studentCode];
    }
  
    function getRandomFullName() {
      const namePrefixes = ['Alfa', 'Bravo', 'Charlie', 'Delta', 'Echo', 'Foxtrot', 'Golf', 'Hotel', 'India', 'Juliett', 'Kilo', 'Lima', 'Mike'];
      const nameSuffixes = ['November', 'Oscar', 'Papa', 'Quebec', 'Romeo', 'Sierra', 'Tango', 'Uniform', 'Victor', 'Whiskey', 'Xray', 'Yankee', 'Zulu'];
  
      let firstName = namePrefixes[Math.floor(Math.random() * namePrefixes.length)];
      let lastName = nameSuffixes[Math.floor(Math.random() * nameSuffixes.length)];
  
      return `${firstName} ${lastName}`;
    }
  
    function createRandomGitHubUsername() {
      const usernameChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      let username = '';
      
      for (let i = 0; i < 10; i++) {
        username += usernameChars.charAt(Math.floor(Math.random() * usernameChars.length));
      }
      
      return username;
    }
  
    function getRandomScore() {
      return Math.floor(Math.random() * 11); 
    }
  
    function createDummyStudents(totalStudents) {
      let studentsData = [];
      for (let i = 0; i < totalStudents; i++) {
        let [classInfo, id] = generateClassAndId(Math.floor(Math.random() * 4));
        let name = getRandomFullName();
        let githubUsername = createRandomGitHubUsername();
        let scores = Array.from({ length: 10 }, getRandomScore);
  
        studentsData.push([i + 1, classInfo, id, name, githubUsername, ...scores]);
      }
      return studentsData;
    }
  
    function arrayToCSV(dataArray) {
      return 'data:text/csv;charset=utf-8,' + encodeURIComponent(dataArray.map(e => e.join(',')).join('\n'));
    }
  
    // Event handler to download CSV
    function initiateDownload() {
      let studentData = createDummyStudents(120);
      let csvData = arrayToCSV(studentData);
  
      let downloader = document.createElement('a');
      downloader.href = csvData;
      downloader.setAttribute('download', 'student_data.csv');
      downloader.click();
    }
  
    document.getElementById('downloadButton').addEventListener('click', initiateDownload);
  
    // Populate table with dummy data
    let dummyStudents = createDummyStudents(120);
    dummyStudents.forEach(student => {
      let tableRow = document.createElement('tr');
      student.forEach(data => {
        let tableData = document.createElement('td');
        tableData.textContent = data;
        tableRow.appendChild(tableData);
      });
      document.querySelector('#gradesTable tbody').appendChild(tableRow);
    });
  </script>
  
</body>
</html>
